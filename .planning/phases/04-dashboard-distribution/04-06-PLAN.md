---
phase: 04-dashboard-distribution
plan: 06
type: execute
wave: 2
depends_on: ["04-04"]
files_modified:
  - hivemind/api/routes/well_known.py
  - glama.json
  - scripts/demo.tape
  - README.md
autonomous: false
requirements:
  - DIST-04
  - DIST-06
  - DIST-09

must_haves:
  truths:
    - "HiveMind serves a valid server-card.json at /.well-known/mcp/server-card.json for Smithery discovery"
    - "glama.json exists in repo root for Glama.ai automatic indexing"
    - "A VHS .tape file exists that produces a demo GIF showing two agents sharing knowledge"
    - "Instructions for submitting to all 6 MCP directories are documented and actionable"
  artifacts:
    - path: "hivemind/api/routes/well_known.py"
      provides: "Smithery server-card.json endpoint"
      exports: ["well_known_router"]
    - path: "glama.json"
      provides: "Glama.ai server configuration for automatic indexing"
      contains: "glama.ai"
    - path: "scripts/demo.tape"
      provides: "VHS tape file for reproducible demo GIF generation"
      contains: "Output"
  key_links:
    - from: "hivemind/api/routes/well_known.py"
      to: "hivemind/server/main.py"
      via: "app.include_router(well_known_router)"
      pattern: "well_known_router"
    - from: "scripts/demo.tape"
      to: "README.md"
      via: "Generated demo.gif referenced in README"
      pattern: "demo\\.gif"
---

<objective>
Prepare HiveMind for listing on MCP discovery directories (Smithery, Glama.ai, PulseMCP, mcp.so, AwesomeClaude.ai, punkpeye/awesome-mcp-servers) and create a reproducible demo GIF showing two agents sharing knowledge.

Purpose: Discoverability is critical for adoption. MCP directories are the primary way developers find new MCP servers. The demo GIF demonstrates the core value proposition in 30 seconds.
Output: Smithery server-card endpoint, glama.json, VHS demo tape, and submission-ready instructions.
</objective>

<execution_context>
@/Users/amirkellousidhoum/.claude/get-shit-done/workflows/execute-plan.md
@/Users/amirkellousidhoum/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-dashboard-distribution/04-RESEARCH.md
@.planning/phases/04-dashboard-distribution/04-04-SUMMARY.md
@hivemind/server/main.py
@hivemind/api/router.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Smithery server-card.json endpoint + Glama.ai config</name>
  <files>hivemind/api/routes/well_known.py, glama.json, hivemind/server/main.py</files>
  <action>
**`hivemind/api/routes/well_known.py`:**

Create a FastAPI router that serves the Smithery server-card.json at `/.well-known/mcp/server-card.json`:

```python
from fastapi import APIRouter
from fastapi.responses import JSONResponse

well_known_router = APIRouter(tags=["well-known"])

@well_known_router.get("/.well-known/mcp/server-card.json")
async def server_card():
    return JSONResponse({
        "serverInfo": {
            "name": "hivemind",
            "description": "Shared memory system for AI agents â€” contribute and retrieve knowledge from the collective commons",
            "version": "0.1.0"
        },
        "authentication": {
            "type": "apiKey",
            "in": "header",
            "name": "X-API-Key"
        },
        "tools": [
            {"name": "add_knowledge", "description": "Contribute knowledge to the shared commons"},
            {"name": "search_knowledge", "description": "Search the knowledge commons for relevant items"},
            {"name": "list_knowledge", "description": "List your contributed knowledge items"},
            {"name": "delete_knowledge", "description": "Remove your knowledge contributions"},
            {"name": "publish_knowledge", "description": "Publish knowledge to the public commons"},
            {"name": "manage_roles", "description": "Manage RBAC roles and permissions"},
            {"name": "report_outcome", "description": "Report whether retrieved knowledge was helpful"}
        ]
    })
```

Register this router in `hivemind/server/main.py` â€” add `app.include_router(well_known_router)` BEFORE the MCP mount. Note: this goes on the FastAPI `app` directly (not `api_router`), because the path starts with `/.well-known/` which is a top-level path.

**`glama.json`** â€” Place in repo root:
```json
{
  "$schema": "https://glama.ai/mcp/schemas/server.json",
  "maintainers": ["your-github-username"]
}
```

The maintainers field should use the actual GitHub username (placeholder for now â€” executor should update with real username).
  </action>
  <verify>
`python -c "from hivemind.api.routes.well_known import well_known_router"` succeeds. `test -f glama.json` passes. `grep "well_known_router" hivemind/server/main.py` confirms router is registered.
  </verify>
  <done>Smithery server-card.json served at /.well-known/mcp/server-card.json with all 7 tools listed, and glama.json in repo root for Glama.ai indexing.</done>
</task>

<task type="auto">
  <name>Task 2: VHS demo tape + README demo section</name>
  <files>scripts/demo.tape, README.md</files>
  <action>
**`scripts/demo.tape`** â€” VHS script for reproducible demo GIF:

The demo shows two agents sharing knowledge via MCP. Since we cannot run a real MCP client in VHS, the demo simulates the workflow using curl commands against the REST API (which is equivalent to MCP tool calls per the REST/MCP parity from Phase 3).

```tape
Output scripts/demo.gif
Set FontSize 14
Set Width 1200
Set Height 600
Set Theme "Catppuccin Mocha"

# Title
Type "# HiveMind: Agents Share Knowledge in Real Time"
Enter
Sleep 1s

# Agent 1 contributes knowledge
Type "# Agent 1 discovered a useful workaround and shares it"
Enter
Sleep 500ms
Type@50ms 'curl -s -X POST http://localhost:8000/api/v1/knowledge/search \\'
Enter
Type@50ms '  -H "X-API-Key: $API_KEY" \\'
Enter
Type@50ms '  -H "Content-Type: application/json" | jq .'
Enter
Sleep 2s

# Show result
Type "# Knowledge is now in the commons"
Enter
Sleep 1s

# Agent 2 searches and finds it
Type "# Agent 2 searches for help with the same problem"
Enter
Sleep 500ms
Type@50ms 'curl -s "http://localhost:8000/api/v1/knowledge/search?query=FastAPI+middleware" \\'
Enter
Type@50ms '  -H "X-API-Key: $API_KEY_2" | jq .results[0].title'
Enter
Sleep 2s

# Result
Type "# Agent 2 found Agent 1's knowledge instantly!"
Enter
Sleep 1s

# Agent 2 reports it was helpful
Type "# Agent 2 reports the knowledge was helpful"
Enter
Sleep 500ms
Type@50ms 'curl -s -X POST http://localhost:8000/api/v1/outcomes \\'
Enter
Type@50ms '  -H "X-API-Key: $API_KEY_2" \\'
Enter
Type@50ms '  -H "Content-Type: application/json" \\'
Enter
Type@50ms '  -d '\''{"item_id": "...", "outcome": "solved"}'\'' | jq .'
Enter
Sleep 2s

Type "# The commons gets smarter with every interaction ðŸ§ "
Enter
Sleep 2s
```

Note: The actual demo tape should be refined during execution to use real API responses. The tape file is a template â€” the executor should adjust curl commands to match the actual API and use environment variables for keys (Pitfall 7 from research: no hardcoded paths/keys).

**Update README.md** to add a demo section near the top:
- Add an image reference: `![HiveMind Demo](scripts/demo.gif)` (or a relative path).
- Brief caption: "Two agents sharing knowledge via HiveMind in 30 seconds."
- Note that the demo GIF can be regenerated with `vhs scripts/demo.tape` (requires VHS + ffmpeg + ttyd).

Also add a section "MCP Directory Listings" with links to where HiveMind will be listed, placeholder for actual listing URLs after submission.
  </action>
  <verify>
`test -f scripts/demo.tape` passes. `grep "demo.gif" README.md` confirms demo reference. `grep "Output" scripts/demo.tape` confirms VHS Output directive.
  </verify>
  <done>VHS demo tape at scripts/demo.tape produces a 30-second demo GIF showing the contribute-search-feedback loop, and README references the demo with regeneration instructions.</done>
</task>

<task type="checkpoint:human-action" gate="blocking">
  <name>Task 3: Submit to MCP discovery directories</name>
  <files>N/A (external submissions)</files>
  <action>
All submission artifacts are ready. The user must submit HiveMind to the following directories manually (these are external form/PR submissions that Claude cannot automate):

1. **Smithery.ai (DIST-04):** Run `npx smithery mcp publish "https://your-hivemind.com/mcp"` or submit via smithery.ai/new (requires publicly accessible HTTPS endpoint)
2. **PulseMCP:** Visit pulsemcp.com/submit â€” fill in name (HiveMind), description, GitHub URL
3. **Glama.ai:** glama.json is in repo root â€” push to main, then claim ownership at glama.ai/mcp/servers
4. **mcp.so:** Open GitHub issue on modelcontextprotocol/servers â€” title: "Add HiveMind"
5. **AwesomeClaude.ai:** Submit via awesomeclaude.ai form (curated, may take time)
6. **punkpeye/awesome-mcp-servers:** Open PR on github.com/punkpeye/awesome-mcp-servers following CONTRIBUTING.md format
7. **Official MCP Registry:** Open PR on github.com/modelcontextprotocol/registry following their CONTRIBUTING.md
  </action>
  <verify>
Type "submitted" once the directory submissions are done (or "skip" to defer submissions to later).
  </verify>
  <done>HiveMind is submitted to at least 4 of the 6 target MCP discovery directories.</done>
</task>

</tasks>

<verification>
1. `curl http://localhost:8000/.well-known/mcp/server-card.json` returns valid JSON with serverInfo and tools
2. `test -f glama.json` â€” exists in repo root
3. `test -f scripts/demo.tape` â€” exists with VHS Output directive
4. README references demo.gif and MCP directory listings
</verification>

<success_criteria>
- Smithery server-card.json is served by FastAPI at the correct well-known path
- glama.json is in repo root with valid schema
- VHS demo tape is reproducible and generates a 30-second demo
- All 6 directory submission instructions are documented and actionable
- README updated with demo and directory listing sections
</success_criteria>

<output>
After completion, create `.planning/phases/04-dashboard-distribution/04-06-SUMMARY.md`
</output>
